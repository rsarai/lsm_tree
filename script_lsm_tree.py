list_of_books = [
    "A Christmas Carol in Prose; Being a Ghost Story of Christmas by Charles Dickens (2135)",
    "Pride and Prejudice by Jane Austen (1471)",
    "Frankenstein; Or, The Modern Prometheus by Mary Wollstonecraft Shelley (1353)",
    "Alice's Adventures in Wonderland by Lewis Carroll (844)",
    "Moby Dick; Or, The Whale by Herman Melville (704)",
    "The Yellow Wallpaper by Charlotte Perkins Gilman (657)",
    "The Adventures of Sherlock Holmes by Arthur Conan Doyle (634)",
    "Lao-tzu, A Study in Chinese Philosophy by Thomas Watters (605)",
    "The Scarlet Letter by Nathaniel Hawthorne (568)",
    "A Tale of Two Cities by Charles Dickens (562)",
    "A Modest Proposal by Jonathan Swift (545)",
    "Metamorphosis by Franz Kafka (517)",
    "The Brothers Karamazov by Fyodor Dostoyevsky (507)",
    "Et dukkehjem. English by Henrik Ibsen (468)",
    "The Importance of Being Earnest: A Trivial Comedy for Serious People by Oscar Wilde (459)",
    "Adventures of Huckleberry Finn by Mark Twain (458)",
    "Il Principe. English by Niccolò Machiavelli (444)",
    "War and Peace by graf Leo Tolstoy (422)",
    "Dracula by Bram Stoker (420)",
    "Queen of the Martian Catacombs by Leigh Brackett (407)",
    "The Picture of Dorian Gray by Oscar Wilde (401)",
    "Beowulf: An Anglo-Saxon Epic Poem (398)",
    "Walden, and On The Duty Of Civil Disobedience by Henry David Thoreau (396)",
    "Jane Eyre: An Autobiography by Charlotte Brontë (394)",
    "The Salem Belle: A Tale of 1692 by Ebenezer Wheelwright (388)",
    "The Adventures of Tom Sawyer by Mark Twain (385)",
    "The Strange Case of Dr. Jekyll and Mr. Hyde by Robert Louis Stevenson (369)",
    "The Awakening, and Selected Short Stories by Kate Chopin (358)",
    "The Rebel of Valkyr by Alfred Coppel (350)",
    "Peter Pan by J. M. Barrie (343)",
    "The Souls of Black Folk by W. E. B. Du Bois (341)",
    "The Iliad by Homer (339)",
    "Grimms' Fairy Tales by Jacob Grimm and Wilhelm Grimm (336)",
    "Great Expectations by Charles Dickens (329)",
    "Little Women by Louisa May Alcott (329)",
    "The Republic by Plato (316)",
    "Emma by Jane Austen (310)",
    "Narrative of the Life of Frederick Douglass, an American Slave by Frederick Douglass (308)",
    "Anthem by Ayn Rand (305)",
    "The Prophet by Kahlil Gibran (297)",
    "The Hound of the Baskervilles by Arthur Conan Doyle (276)",
    "The Count of Monte Cristo, Illustrated by Alexandre Dumas (275)",
    "Wuthering Heights by Emily Brontë (271)",
    "Heart of Darkness by Joseph Conrad (271)",
    "Ulysses by James Joyce (266)",
    "The Harim and the Purdah: Studies of Oriental Women by Elizabeth Cooper (258)",
    "Tractatus Logico-Philosophicus by Ludwig Wittgenstein (258)",
    "Dubliners by James Joyce (253)",
    "A Christmas Carol by Charles Dickens (251)",
    "Treasure Island by Robert Louis Stevenson (251)",
    "Uncle Tom's Cabin by Harriet Beecher Stowe (249)",
    "Siddhartha by Hermann Hesse (248)",
    "The Slang Dictionary: Etymological, Historical and Andecdotal by John Camden Hotten (245)",
    "Anne of Green Gables by L. M. Montgomery (240)",
    "Star Ship by Poul Anderson (240)",
    "Leviathan by Thomas Hobbes (238)",
    "Prestuplenie i nakazanie. English by Fyodor Dostoyevsky (237)",
    "Beyond Good and Evil by Friedrich Wilhelm Nietzsche (229)",
    "The War of the Worlds by H. G. Wells (226)",
    "The Wonderful Wizard of Oz by L. Frank Baum (223)",
    "Les Misérables by Victor Hugo (212)",
    "As It Was by Paul L. Payne (211)",
    "The Kama Sutra of Vatsyayana by Vatsyayana (211)",
    "Anna Karenina by graf Leo Tolstoy (207)",
    "The Turn of the Screw by Henry James (204)",
    "Don Quixote by Miguel de Cervantes Saavedra (203)",
    "The Odyssey by Homer (201)",
    "Pygmalion by Bernard Shaw (201)",
    "Mostly About Nibble the Bunny by John Breck (200)",
    "The Convict Ship, Volume 1 (of 3) by William Clark Russell (200)",
    "Also sprach Zarathustra. English by Friedrich Wilhelm Nietzsche (197)",
    "Alexander the Great by Jacob Abbott (197)",
    "The Call of the Wild by Jack London (195)",
    "The Happy Prince, and Other Tales by Oscar Wilde (194)",
    "Divine Comedy, Longfellow's Translation, Hell by Dante Alighieri (192)",
    "A Study in Scarlet by Arthur Conan Doyle (192)",
    "Plain Tales from the Hills by Rudyard Kipling (189)",
    "Essays of Michel de Montaigne — Complete by Michel de Montaigne (187)",
    "David Copperfield by Charles Dickens (186)",
    "The Philippines a Century Hence by José Rizal (186)",
    "Sense and Sensibility by Jane Austen (183)",
    "A Journal of the Plague Year by Daniel Defoe (178)",
    "Waldmüller: Bilder und Erlebnisse (173)",
    "Le jardin des supplices by Octave Mirbeau (172)",
    "An Index of The Divine Comedy by Dante by Dante Alighieri (170)",
    "A Dictionary of Cebuano Visayan by John U. Wolff (170)",
    "Mercy Flight by Mack Reynolds (169)",
    "The Masque of the Red Death by Edgar Allan Poe (167)",
    "The Time Machine by H. G. Wells (165)",
    "Twas the Night before Christmas: A Visit from St. Nicholas by Clement Clarke Moore (164)",
    "A Pickle for the Knowing Ones by Timothy Dexter (163)",
    "The Elements of Style by William Strunk (163)",
    "Complete Original Short Stories of Guy De Maupassant by Guy de Maupassant (161)",
    "The Nursery Rhymes of England (159)",
    "Manifest der Kommunistischen Partei. English by Friedrich Engels and Karl Marx (159)",
    "Three Men in a Boat (To Say Nothing of the Dog) by Jerome K. Jerome (158)",
    "The Legend of Sleepy Hollow by Washington Irving (158)",
    "Through the Looking-Glass by Lewis Carroll (158)",
    "Incidents in the Life of a Slave Girl, Written by Herself by Harriet A. Jacobs (157)",
    "Major Barbara by Bernard Shaw (156)"]

top_authors = [
    ["Dickens, Charles", 228468],
    ["Leech, John", 119017],
    ["Austen, Jane", 86816],
    ["Shelley, Mary Wollstonecraft", 66219],
    ["Twain, Mark", 66064],
    ["Doyle, Arthur Conan", 62276],
    ["Wilde, Oscar", 56475],
    ["Carroll, Lewis", 41339],
    ["Hawthorne, Nathaniel", 40023],
    ["Stevenson, Robert Louis", 38870],
    ["Shakespeare, William", 35641],
    ["Dostoyevsky, Fyodor", 33262],
    ["Wells, H. G. (Herbert George)", 32161],
    ["Swift, Jonathan", 30582],
    ["Tolstoy, Leo, graf", 29140],
    ["Melville, Herman", 29114],
    ["Foote, Mary Hallock", 27721],
    ["Anthony, A. V. S. (Andrew Varick Stout)", 27564],
    ["Ipsen, Ludvig Sandöe", 27564],
    ["Nietzsche, Friedrich Wilhelm", 27521],
    ["Poe, Edgar Allan", 27100],
    ["Kafka, Franz", 25887],
    ["Homer", 25748],
    ["Plato", 24474],
    ["Ibsen, Henrik", 24358],
    ["London, Jack", 23473],
    ["Wyllie, David (Translator)", 22956],
    ["Baum, L. Frank (Lyman Frank)", 22928],
    ["Jowett, Benjamin", 22904],
    ["Garnett, Constance", 22799],
    ["Conrad, Joseph", 22300],
    ["Joyce, James", 22084],
    ["Dumas, Alexandre", 21949],
    ["Vestal, Herman B.", 21798],
    ["Dante Alighieri", 21748],
    ["Gilman, Charlotte Perkins", 21588],
    ["James, Henry", 21112],
    ["Alcott, Louisa May", 20164],
    ["Verne, Jules", 20162],
    ["Doré, Gustave", 20052],
    ["Thoreau, Henry David", 19914],
    ["Rizal, José", 19872],
    ["Kipling, Rudyard", 19562],
    ["Shaw, Bernard", 18878],
    ["Chesterton, G. K. (Gilbert Keith)", 18870],
    ["Kemble, E. W. (Edward Windsor)", 18505],
    ["Montgomery, L. M. (Lucy Maud)", 18330],
    ["Smith, Jessie Willcox", 17810],
    ["Wodehouse, P. G. (Pelham Grenville)", 17648],
    ["Moore, Clement Clarke", 17593],
    ["Hugo, Victor", 17139],
    ["Russell, Bertrand", 16942],
    ["Brontë, Charlotte", 16484],
    ["Rand, Ayn", 16462],
    ["Rackham, Arthur", 16332],
    ["Lang, Andrew", 15938],
    ["Pope, Alexander", 15728],
    ["Henry, O.", 15643],
    ["Defoe, Daniel", 15498],
    ["Stoker, Bram", 15426],
    ["Widger, David", 15426],
    ["Barrie, J. M. (James Matthew)", 15385],
    ["Cervantes Saavedra, Miguel de", 15295],
    ["Irving, Washington", 15192],
    ["Chopin, Kate", 15128],
    ["Williams, George Alfred", 14976],
    ["Wharton, Edith", 14969],
    ["Christie, Agatha", 14937],
    ["Chekhov, Anton Pavlovich", 14780],
    ["Machiavelli, Niccolò", 14721],
    ["Townsend, F. H. (Frederick Henry)", 14666],
    ["Grimm, Wilhelm", 14498],
    ["Grimm, Jacob", 14498],
    ["Burnett, Frances Hodgson", 13941],
    ["Maude, Louise", 13769],
    ["Maude, Aylmer", 13560],
    ["Hall, J. Lesslie (John Lesslie)", 13289],
    ["Marriott, W. K. (William Kenaz)", 13247],
    ["Morley, Henry", 13228],
    ["Douglass, Frederick", 13163],
    ["Anderson, Poul", 12611],
    ["Goethe, Johann Wolfgang von", 12517],
    ["Du Bois, W. E. B. (William Edward Burghardt)", 11996],
    ["Maupassant, Guy de", 11801],
    ["Balzac, Honoré de", 11765],
    ["Hardy, Thomas", 11385],
    ["Scott, Walter", 11332],
    ["Voltaire", 11328],
    ["Butler, Samuel", 11323],
    ["Cary, Henry Francis", 11083],
    ["Robertson, James Alexander", 11074],
    ["Potter, Beatrix", 11004],
    ["Derbyshire, Charles E.", 10947],
    ["Hapgood, Isabel Florence", 10927],
    ["Buckley, Theodore Alois", 10779],
    ["Eliot, George", 10657],
    ["Stowe, Harriet Beecher", 10654],
    ["Bierce, Ambrose", 10538],
    ["Ormsby, John", 10417],
    ["Dexter, Timothy", 10327]
]


import os
from lsm_tree import LSM_tree


def count_vowels(mystr):
    return sum(list(map(mystr.lower().count, "aeiou")))

def count_as(mystr):
    return sum(list(map(mystr.lower().count, "a")))


location = '/home/sarai/github-projects/lsm-trees/files/lsm_test'
lsm_tree = LSM_tree(
    name="home-pc",
    default_path=location,
    buffer_capacity=150,
)

try:
    for book in list_of_books[:10]:
        lsm_tree.insert(book, count_vowels(book))

    # lsm_tree.show()

    for book in list_of_books[:10]:
        lsm_tree.insert(book, count_vowels(book))

    # lsm_tree.show()

    for book in list_of_books[:10]:
        lsm_tree.insert(book, count_as(book))

    for book in list_of_books[10:]:
        lsm_tree.insert(book, count_vowels(book))

    for author_info in top_authors:
        lsm_tree.insert(author_info[0], author_info[1])

    # lsm_tree.show()
    # for i in os.listdir(location):
    #     if i == "__init__.py":
    #         continue
    #     print("\n\n")
    #     print(i)
    #     with open(location + "/" + i, "r") as f:
    #         print(f.read())

    expected_result = [12, 7, 66064, 11328, 25748]
    words = [
        "Sense and Sensibility by Jane Austen (183)",
        "Emma by Jane Austen (310)",
        "Twain, Mark", "Voltaire", "Homer"
    ]
    for w, result in zip(words, expected_result):
        assert int(lsm_tree.search(w)) == result

except Exception as e:
    raise e
finally:
    for i in os.listdir(location):
        if i == "__init__.py":
            continue
        os.remove(location + "/" + i)
